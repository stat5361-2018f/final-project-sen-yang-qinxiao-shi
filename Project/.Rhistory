scale_fill_brewer(palette="Dark2") +
labs(x="x", y="density", title = "Overlaid Histogram between Sample and True PMF") )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1, fill= "#E69F00",
aes(x=X, y=..density..,color="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity", fill= "#56B4E9",
aes(x,y,color="True")) +
scale_color_manual(values=c("#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#E69F00", "#56B4E9"))+
labs(x="x", y="density", title = "Overlaid Histogram between Sample and True PMF") )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1, fill= "#999999",
aes(x=X, y=..density..,color="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity", fill= "#E69F00",
aes(x,y,color="True")) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = "Overlaid Histogram between Sample and True PMF") )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1, fill= "#999999", alpha=0.5,
aes(x=X, y=..density..,color="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity", fill= "#E69F00",
aes(x,y,color="True"), alpha =0.2) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = "Overlaid Histogram between Sample and True PMF") )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1, fill= "#999999", alpha=0.5,
aes(x=X, y=..density..,color="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity", fill= "#999999",
aes(x,y,color="True"), alpha =0.2) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = "Overlaid Histogram between Sample and True PMF") )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1, fill= "#999999", alpha=0.5,
aes(x=X, y=..density..,color="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity", fill= "#999999",
aes(x,y,color="True"), alpha =0.2) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1, fill= "#999999", alpha=0.5,
aes(x=X, y=..density..,color="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity", fill= "#E69F00",
aes(x,y,color="True"), alpha =0.2) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=0.5,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.2) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=0.5,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.5) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=1,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.5) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=1,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.5) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+ guides(fill = FALSE) +
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=1,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.5) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=1,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.5) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
}
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=1,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.5) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
}
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
set.seed(20181116)
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
return(data.frame(X))
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=samples[[i]],binwidth=1 , alpha=0.8,
aes(x=X, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#999999", "#E69F00"))+
scale_fill_manual(values=c("#999999", "#E69F00"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste(
"Overlaid Histogram between Sample and True PMF with p =",p[i])) )
}
View(samples)
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
return(data.frame(X))
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
View(samples)
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
return(data.frame(X))
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
View(samples)
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
set.seed(20181116)
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
return(data.frame(X))
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
View(samples)
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
set.seed(20181116)
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
return(data.frame(X))
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
View(samples)
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
}
View(samples)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
View(samples)
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5))
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5))
i=1
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5))
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4)
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x=x,y=y,color="True",fill="True"), alpha =0.4)
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x=x,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4)
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample"))
print(ggplot() + geom_histogram(samples[[i]],binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
print(ggplot() + geom_histogram(data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
print(ggplot() + geom_histogram(data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
ggplot() + geom_histogram(data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample"))
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x_seq <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x_seq/x_seq
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..))
ggplot() + geom_histogram(samples[[i]],binwidth=1,
+                                   alpha=0.8,aes(x=x, y=..density..))
ggplot() + geom_histogram(samples[[i]],binwidth=1, alpha=0.8,aes(x=x, y=..density..))
ggplot(samples[[i]]) + geom_histogram(binwidth=1, alpha=0.8,aes(x=x, y=..density..))
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
set.seed(20181116)
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
set.seed(20181116)
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
X
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
# Q2: rejection sampling
## function rlogseries
rlogseries <- function(n,p) {
U <- runif(n)
X <- rgeom(n,p) + 1
for (i in 1:n) {
if (U[i] > (1/X[i])) {X[i] <- 0}
}
X <- X[which(X!=0)]
X
}
## samples and plots
n <- 1000; p <- c(0.25, 0.50, 0.75)
s1 <- s2 <- s3 <- NULL
samples <- list(s1,s2,s3)
x <- seq(1,25,1)
library(ggplot2)
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
for (i in 1: length(p)) {
samples[[i]] <- rlogseries(n,p[i])
true_pmf <- -1/log(1-p[i])*p[i]^x/x
print(ggplot() + geom_histogram(data=data.frame(x=samples[[i]]),binwidth=1,
alpha=0.8,aes(x=x, y=..density..,color="Sample",fill="Sample")) +
geom_bar(data=data.frame(x=x,y=true_pmf), stat = "identity",
aes(x,y,color="True",fill="True"), alpha =0.4) +
scale_color_manual(values=c("#E69F00", "#999999"))+
scale_fill_manual(values=c("#E69F00", "#999999"))+ guides(color = FALSE) +
labs(x="x", y="density", title = paste("Overlaid Histogram when p =",p[i])) +
theme(plot.title = element_text(hjust = 0.5)))
}
